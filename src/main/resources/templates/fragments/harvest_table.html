<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <body>
        <!-- This fragment will contain just the table content for AJAX pagination -->
        <div th:fragment="harvestTable">
            <div class="info-card" th:if="${harvestList == null or harvestList.isEmpty()}">
                <span class="material-symbols-outlined icon">eco</span>
                <h2>No se encontraron cosechas</h2>
                <p>Intenta con otros filtros o <a th:href="@{/harvests/form}">registra una nueva cosecha</a>.</p>
            </div>

            <div class="table-container" th:unless="${harvestList == null or harvestList.isEmpty()}">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Código</th>
                                <th>Tipo</th>
                                <th>Fecha de Cosechado</th>
                                <th>Total (kg)</th>
                                <th>Calidad</th>
                                <th>Destino</th>
                                <th>Registrado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="tempList : ${harvestList}">
                                <td th:text="${tempList.idHarvest}"></td>
                                <td th:text="${tempList.typeHarvest}"></td>
                                <td th:text="${tempList.dateHarvested}"></td>
                                <td class="numeric-display" th:text="${#numbers.formatDecimal(tempList.quantityHarvested, 1, 2, 'POINT')}"></td>
                                <td>
                                    <span class="status" 
                                          th:classappend="${#strings.equals(tempList.quality, 'Premium')} ? 'status-optimo' : 
                                          (${#strings.equals(tempList.quality, 'Estándar')} ? '' : 'status-bajo')" 
                                          th:text="${tempList.quality}">
                                    </span>
                                </td>
                                <td th:text="${tempList.destiny}"></td>
                                <td>
                                    <span class="status" 
                                          th:classappend="${tempList.registeredHarvest} ? 'status-optimo' : 'status-bajo'" 
                                          th:text="${tempList.registeredHarvest ? 'Sí' : 'No'}">
                                    </span>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <a th:href="@{/harvests/edit(idHarvest=${tempList.idHarvest})}" class="btns edit-btns" title="Editar">
                                            <span class="material-symbols-outlined icon">edit</span>
                                        </a>
                                        <form th:action="@{/harvests/delete}" method="post" class="confirm-action" data-message="¿Eliminar esta cosecha?" data-title="Confirmar Eliminación" style="margin:0; padding:0; display:inline;">
                                            <input type="hidden" name="idHarvest" th:value="${tempList.idHarvest}" />
                                            <button type="submit" class="btns delete-btns" title="Eliminar">
                                                <span class="material-symbols-outlined icon">delete</span>
                                            </button>
                                        </form>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>
</html>